
## gradient of the neural network
dNN_dq = gradient(u -> NN(u, initial_params(NN))[1], u0)[1] ## ∂H/∂q
dNN_dp = gradient(u -> NN(u, initial_params(NN))[1], nn_u0)[1] ## ∂H/∂p